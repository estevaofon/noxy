
let a: int = 10
let b: int = 20

// Correct swap implementation:
// Must read BOTH values into int variables first, then UPDATE.
// Using x = y directly would REBIND (since y is ref int), not UPDATE.
func swap(x: ref int, y: ref int)
    let val_x: int = x   // Read value from x (auto-deref)
    let val_y: int = y   // Read value from y (auto-deref)
    x = val_y            // UPDATE: write val_y to target of x
    y = val_x            // UPDATE: write val_x to target of y
end

func verify()
    print("Before:", a, b)
    if a != 10 || b != 20 then
        print("FAIL: Initial values incorrect")
        return
    end

    swap(a, b)

    print("After:", a, b)
    if a != 20 || b != 10 then
        print("FAIL: Swap failed")
    else
        print("SUCCESS: Swap passed")
    end
end

verify()
